tosca_definitions_version: tosca_simple_yaml_1_0

imports:
  - TOSCA_kubernetes_defenition_1_0.YAML

topology_template:
    node_templates:
      deploymentAndPod:
        type:  kubernetes.nodes.KubeObj
        properties:
          replicas: 3
          selector:
            matchLabels: ['app : nginx']
          template:
            - metadata:
                labels:
                  app: nginx
              spec:
                containers:
                  - name: nginx
                    image: nginx:1.7.9
                    resources:
                      limits:
                          cpu:  0.1 GHz
                          memory: 500 MB
      service:
        type:  kubernetes.nodes.Service
        properties:
          spec:
            clusterIP: 10.0.171.239
            externalIPs: 80.11.12.10
            ports:
              - protocol: TCP
                targetPort: my-pods
